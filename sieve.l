# 25feb10abu
# (c) Software Lab. Alexander Burger

# Sieve of Eratosthenes
(de sieve (N)
   (let Sieve (range 1 N)
      (set Sieve)
      (for I (cdr Sieve)
         (when I
            (for (S (nth Sieve (* I I)) S (nth (cdr S) I))
               (set S) ) ) )
      (filter bool Sieve) ) )

# vi:et:ts=3:sw=3

(let L (sieve 1000)
   (test 76127 (apply + L))
   (test
      19590340644999083431262508198206381046123972390589368223882605328968666316379870661851951648789482321596229559115436019149189529725215266728292282990852649023362731392404017939142010958261393634959471483757196721672243410067118516227661133135192488848989914892157188308679896875137439519338903968094905549750386407106033836586660683539201011635917900039904495065203299749542985993134669814805318474080581207891125910
      (apply * L) ) )
(msg 'sieve-OK)

